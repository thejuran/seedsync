version: "3.4"
services:
  tests:
    image: seedsync/test/e2e
    container_name: seedsync_test_e2e
    build:
      context: ../../../../
      dockerfile: src/docker/test/e2e/Dockerfile
      target: seedsync_test_e2e
    depends_on:
      - remote
    # Playwright needs more shared memory for browser
    shm_size: 1024M

  remote:
    image: seedsync/test/e2e/remote
    container_name: seedsync_test_e2e_remote
    build:
      context: ../../../../
      dockerfile: src/docker/test/e2e/remote/Dockerfile

  configure:
    image: seedsync/test/e2e/configure
    container_name: seedsync_test_e2e_configure
    build:
      context: ../../../../
      dockerfile: src/docker/test/e2e/configure/Dockerfile
    depends_on:
      - myapp
