---
phase: 10-lint-cleanup
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/angular/src/app/common/capitalize.pipe.ts
  - src/angular/src/app/common/localization.ts
  - src/angular/src/app/pages/autoqueue/autoqueue-page.component.ts
  - src/angular/src/app/pages/files/file-list.component.ts
  - src/angular/src/app/pages/files/file-options.component.ts
  - src/angular/src/app/pages/files/file.component.ts
  - src/angular/src/app/pages/logs/logs-page.component.ts
  - src/angular/src/app/pages/main/app.component.ts
  - src/angular/src/app/pages/main/header.component.ts
  - src/angular/src/app/pages/main/sidebar.component.ts
  - src/angular/src/app/pages/settings/option.component.ts
  - src/angular/src/app/pages/settings/settings-page.component.ts
  - src/angular/src/app/tests/mocks/mock-stream-service.registry.ts
  - src/angular/src/app/tests/unittests/pages/files/bulk-actions-bar.component.spec.ts
  - src/angular/src/app/tests/unittests/services/base/base-stream.service.spec.ts
  - src/angular/src/app/tests/unittests/services/base/stream-service.registry.spec.ts
autonomous: true

must_haves:
  truths:
    - "All page component methods have explicit return type annotations"
    - "All Angular lifecycle methods return void explicitly"
    - "Common utility functions have explicit return types"
    - "Test helper functions have explicit return types"
  artifacts:
    - path: "src/angular/src/app/common/localization.ts"
      provides: "19 utility functions with explicit return types"
      contains: "): string"
    - path: "src/angular/src/app/pages/files/file.component.ts"
      provides: "11 methods with explicit return types"
      contains: "): void"
  key_links: []
---

<objective>
Add explicit return type annotations to all page components, common utilities, and test files to complete the return type coverage.

Purpose: Complete type safety across the presentation layer and test infrastructure, ensuring all functions are explicitly typed per typescript-eslint best practices.

Output: ~72 return type warnings resolved in 16 files.
</objective>

<execution_context>
@/Users/julianamacbook/.claude/get-shit-done/workflows/execute-plan.md
@/Users/julianamacbook/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/10-lint-cleanup/10-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add return types to common utilities</name>
  <files>
src/angular/src/app/common/capitalize.pipe.ts
src/angular/src/app/common/localization.ts
  </files>
  <action>
Add explicit return type annotations to common utility functions:

**capitalize.pipe.ts (1 method):**
```typescript
// Before
transform(value: any) {

// After
transform(value: string): string {
```
Note: The `any` parameter type will be fixed in Plan 04.

**localization.ts (~19 functions):**
This file has many utility functions for formatting. Add return types to each:

```typescript
// Examples of patterns to apply:

// String formatters
static Localize = {
    duration(totalSize: number): string {
        // ...
    },
    fileSize(size: number): string {
        // ...
    },
    // etc.
}
```

Lines needing `: string` return type:
8, 15, 19, 26, 30, 35, 39, 49, 51, 53, 55, 57, 61, 63, 65, 67, 69, 73, 75

All these are string formatting functions that return strings.
  </action>
  <verify>
```bash
cd src/angular && npm run lint 2>&1 | grep -E "capitalize.pipe.ts|localization.ts" | grep "explicit-function-return-type"
# Should return empty (no matches)
```
  </verify>
  <done>All common utility functions have explicit return types.</done>
</task>

<task type="auto">
  <name>Task 2: Add return types to page components</name>
  <files>
src/angular/src/app/pages/autoqueue/autoqueue-page.component.ts
src/angular/src/app/pages/files/file-list.component.ts
src/angular/src/app/pages/files/file-options.component.ts
src/angular/src/app/pages/files/file.component.ts
src/angular/src/app/pages/logs/logs-page.component.ts
src/angular/src/app/pages/main/app.component.ts
src/angular/src/app/pages/main/header.component.ts
src/angular/src/app/pages/main/sidebar.component.ts
src/angular/src/app/pages/settings/option.component.ts
src/angular/src/app/pages/settings/settings-page.component.ts
  </files>
  <action>
Add explicit return type annotations to all page component methods:

**Common patterns for Angular components:**

```typescript
// Lifecycle methods - always void
ngOnInit(): void { }
ngOnDestroy(): void { }
ngAfterViewInit(): void { }

// Event handlers - always void
onClick(): void { }
onSubmit(): void { }
onFileSelected(file: ViewFile): void { }

// Template helpers - return their actual type
getStatusClass(): string { }
isSelected(file: ViewFile): boolean { }
get fileCount(): number { }

// Setters - void (implicit but should be explicit)
set selectedItem(value: Item): void { }
```

**Files and approximate method counts:**

1. **autoqueue-page.component.ts** (3 methods): Lines 55, 80, 102 - add `: void`
2. **file-list.component.ts** (5 methods): Lines 171, 177, 183, 189, 195 - add `: void`
3. **file-options.component.ts** (6 methods): Lines 44, 63, 102, 106, 110, 114 - add `: void`
4. **file.component.ts** (11 methods): Lines 115, 130, 134, 138, 142, 146, 155, 164, 173, 182, 197 - add `: void` or appropriate type
5. **logs-page.component.ts** (9 methods): Lines 67, 79, 92, 97, 105, 110, 115, 119, 137 - add `: void`
6. **app.component.ts** (2 methods): Lines 34, 44 - add `: void`
7. **header.component.ts** (2 methods): Lines 43, 47 - add `: void`
8. **sidebar.component.ts** (2 methods): Lines 33, 41 - add `: void`
9. **option.component.ts** (1 method): Line 45 - add `: void`
10. **settings-page.component.ts** (3 methods): Lines 63, 77, 111 - add `: void`
  </action>
  <verify>
```bash
cd src/angular && npm run lint 2>&1 | grep "/pages/" | grep "explicit-function-return-type"
# Should return empty (no matches)
```
  </verify>
  <done>All page component methods have explicit return types.</done>
</task>

<task type="auto">
  <name>Task 3: Add return types to test files</name>
  <files>
src/angular/src/app/tests/mocks/mock-stream-service.registry.ts
src/angular/src/app/tests/unittests/pages/files/bulk-actions-bar.component.spec.ts
src/angular/src/app/tests/unittests/services/base/base-stream.service.spec.ts
src/angular/src/app/tests/unittests/services/base/stream-service.registry.spec.ts
  </files>
  <action>
Add explicit return type annotations to test helper functions and mocks:

**mock-stream-service.registry.ts:**
- Add return types to all mock methods

**Test spec files:**
- Add `: void` to test helper functions
- Add appropriate return types to factory functions

Common test patterns:
```typescript
// Test setup helpers
function createComponent(): ComponentFixture<MyComponent> { }
function createService(): MyService { }

// Mock factories
function createMockFile(): ViewFile { }

// Async helpers
async function waitForChange(): Promise<void> { }
```

Note: Jasmine/Jest `describe`, `it`, `beforeEach` callbacks don't need return types - they're handled by the testing framework types.
  </action>
  <verify>
```bash
cd src/angular && npm run lint 2>&1 | grep -E "mock-stream-service.registry.ts|bulk-actions-bar.component.spec.ts|base-stream.service.spec.ts|stream-service.registry.spec.ts" | grep "explicit-function-return-type"
# Should return empty (no matches)
```
  </verify>
  <done>All test helper functions have explicit return types.</done>
</task>

</tasks>

<verification>
```bash
# Verify all return type issues fixed
cd src/angular && npm run lint 2>&1 | grep "explicit-function-return-type"
# Expected: No output (all 152 return type warnings fixed)

# Count total remaining issues
cd src/angular && npm run lint 2>&1 | tail -1
# Expected: Around 111 problems (282 - 152 return types - 19 empty functions - 4 style = ~107,
# but some overlap, so expect ~100-120)

# Run unit tests
cd src/angular && npm test -- --watch=false
# Expected: All tests pass
```
</verification>

<success_criteria>
1. Zero `explicit-function-return-type` warnings in entire codebase
2. All 387 unit tests still pass
3. LINT-01 requirement complete (all 152 return type warnings resolved)
</success_criteria>

<output>
After completion, create `.planning/phases/10-lint-cleanup/10-03-SUMMARY.md`
</output>
