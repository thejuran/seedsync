---
phase: 27-webhook-import-detection
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/angular/src/app/pages/settings/settings-page.component.html
  - src/angular/src/app/pages/settings/settings-page.component.scss
autonomous: true

must_haves:
  truths:
    - "Settings UI displays webhook URL for Sonarr with port from config"
    - "Settings UI displays webhook URL for Radarr with port from config"
    - "Webhook URLs are always visible (not gated by enable toggles)"
    - "User sees clear instructions on where to configure webhooks in Sonarr/Radarr"
  artifacts:
    - path: "src/angular/src/app/pages/settings/settings-page.component.html"
      provides: "Webhook URLs section in *arr Integration card"
      contains: "webhook"
    - path: "src/angular/src/app/pages/settings/settings-page.component.scss"
      provides: "Styles for webhook URL display"
      contains: "webhook"
  key_links:
    - from: "src/angular/src/app/pages/settings/settings-page.component.html"
      to: "config async pipe"
      via: "Reads web.port from config observable for URL display"
      pattern: "config.*async.*web.*port"
---

<objective>
Add webhook URL display to the *arr Integration section in Settings. Show the Sonarr and Radarr
webhook URLs with the configured port so users can copy-paste them into their Sonarr/Radarr
webhook configuration.

Purpose: Users need to know the webhook endpoint URLs to configure in Sonarr/Radarr settings.
Without this, the webhook feature is undiscoverable.

Output: Webhook URLs displayed in Settings page with clear instructions.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/27-webhook-import-detection/27-RESEARCH.md

@src/angular/src/app/pages/settings/settings-page.component.html
@src/angular/src/app/pages/settings/settings-page.component.scss
@src/angular/src/app/pages/settings/settings-page.component.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add webhook URL display section and styles to Settings page</name>
  <files>
    src/angular/src/app/pages/settings/settings-page.component.html
    src/angular/src/app/pages/settings/settings-page.component.scss
  </files>
  <action>
    **Modify `src/angular/src/app/pages/settings/settings-page.component.html`:**

    Add a "Webhook URLs" subsection inside the *arr Integration card body, AFTER the Radarr
    `</fieldset>` (line 144) and BEFORE the closing `</div>` of `.card-body` (line 145).

    The webhook URLs are NOT gated by the Sonarr/Radarr enable toggles because webhooks are
    always-on -- if a webhook is configured in *arr, it works regardless of the enable toggle.
    The enable toggles only control the Test Connection feature.

    Insert the following HTML:

    ```html
    <h4 class="subsection-header">Webhook URLs</h4>
    <div class="webhook-urls">
        <p class="webhook-description">
            Configure these URLs in your *arr apps under Settings &rarr; Connect &rarr; Add &rarr; Webhook.
            Replace <code>&lt;seedsync-address&gt;</code> with your SeedSync server's IP or hostname.
        </p>
        <div class="webhook-url-item">
            <label>Sonarr Webhook URL</label>
            <div class="webhook-url-display">
                <code>http://&lt;seedsync-address&gt;:{{(config | async)?.get('web')?.get('port')}}/server/webhook/sonarr</code>
            </div>
        </div>
        <div class="webhook-url-item">
            <label>Radarr Webhook URL</label>
            <div class="webhook-url-display">
                <code>http://&lt;seedsync-address&gt;:{{(config | async)?.get('web')?.get('port')}}/server/webhook/radarr</code>
            </div>
        </div>
    </div>
    ```

    The `(config | async)?.get('web')?.get('port')` expression reads the web server port from the
    config observable, which is the same pattern used throughout this template. This will render as
    e.g. `http://<seedsync-address>:8800/server/webhook/sonarr`.

    DO NOT try to auto-detect the server address (per research Pitfall 6). Use `<seedsync-address>`
    placeholder.

    ---

    **Modify `src/angular/src/app/pages/settings/settings-page.component.scss`:**

    Add styles for the webhook URL display section. Place these INSIDE the `.card-body` block
    (after the existing `.subsection-header` and `.test-connection` rules, around line 48).

    Add the following SCSS rules inside the `.card-body` block:

    ```scss
    .webhook-urls {
        margin: 0 20px;

        .webhook-description {
            font-size: 85%;
            color: var(--bs-secondary);
            margin-bottom: 12px;

            code {
                font-size: 95%;
            }
        }

        .webhook-url-item {
            margin-bottom: 10px;

            label {
                font-size: 90%;
                font-weight: 500;
                margin-bottom: 2px;
            }

            .webhook-url-display {
                code {
                    display: block;
                    background: var(--bs-dark);
                    color: var(--bs-light);
                    padding: 6px 10px;
                    border-radius: 4px;
                    font-size: 85%;
                    word-break: break-all;
                    user-select: all;
                }
            }
        }
    }
    ```

    Key styling decisions:
    - `user-select: all` on the `<code>` block so clicking selects the entire URL for easy copying.
    - Dark background with light text for the URL display (using Bootstrap CSS variables for
      consistency with the app's theme).
    - `word-break: break-all` prevents long URLs from overflowing on narrow screens.
    - Font sizes and margins match existing Settings page patterns.
    - Uses `var(--bs-dark)` and `var(--bs-light)` which are Bootstrap 5.3 CSS variables already
      used in this codebase (per v1.0 migration).
  </action>
  <verify>
    Build the Angular app to verify no template or SCSS errors:
    `cd /Users/julianamacbook/seedsync/src/angular && node_modules/@angular/cli/bin/ng build --configuration development 2>&1 | tail -5`
    Build should succeed without errors.

    Verify the HTML contains webhook references:
    `grep -c "webhook" /Users/julianamacbook/seedsync/src/angular/src/app/pages/settings/settings-page.component.html`
    (Should be >= 5 references.)

    Verify the SCSS contains webhook styles:
    `grep -c "webhook" /Users/julianamacbook/seedsync/src/angular/src/app/pages/settings/settings-page.component.scss`
    (Should be >= 3 references.)
  </verify>
  <done>
    Settings page shows a "Webhook URLs" subsection in the *arr Integration card with:
    - A description paragraph explaining where to configure webhooks in *arr apps
    - Sonarr webhook URL: `http://<seedsync-address>:{port}/server/webhook/sonarr`
    - Radarr webhook URL: `http://<seedsync-address>:{port}/server/webhook/radarr`
    - Port dynamically read from config
    - URLs styled with dark background, easy-to-copy selection, responsive layout
    - Angular build succeeds with no errors
  </done>
</task>

</tasks>

<verification>
1. Angular build succeeds: `cd /Users/julianamacbook/seedsync/src/angular && node_modules/@angular/cli/bin/ng build --configuration development`
2. Webhook URLs visible in template HTML
3. SCSS compiles without errors
4. No changes to settings-page.component.ts required (config observable already available)
</verification>

<success_criteria>
- Settings page *arr Integration section shows "Webhook URLs" subsection
- Both Sonarr and Radarr webhook URLs displayed with dynamic port from config
- URLs are not gated by enable toggles (always visible)
- Styled consistently with existing Settings page patterns
- Angular build succeeds with zero errors
</success_criteria>

<output>
After completion, create `.planning/phases/27-webhook-import-detection/27-02-SUMMARY.md`
</output>
